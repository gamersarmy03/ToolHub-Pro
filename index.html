<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cross Speed</title>
  <style>
    html, body {
      margin: 0;
      overflow: hidden;
      height: 100%;
      background: #000;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
    canvas {
      display: block;
    }
    #controls {
      position: fixed;
      bottom: 20px;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 0 20px;
      pointer-events: none;
    }
    .button {
      pointer-events: all;
      width: 80px;
      height: 80px;
      border: 2px solid #fff;
      border-radius: 50%;
      background: transparent;
      color: #fff;
      font-size: 14px;
      font-weight: bold;
      text-align: center;
      line-height: 80px;
      transition: transform 0.1s, background 0.2s;
    }
    .button:active {
      transform: scale(0.9);
      background: rgba(255, 255, 255, 0.2);
    }
  </style>
</head>
<body>
  <div id="controls">
    <button id="brake" class="button">Brake</button>
    <button id="accelerate" class="button">Accelerate</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/examples/js/controls/OrbitControls.js"></script>
  <script>
    // Scene, Camera, Renderer
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(70, window.innerWidth/window.innerHeight, 0.1, 1000);
    camera.position.set(0, 5, 10);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Sky Gradient
    const skyColor = new THREE.Color(0x87ceeb);
    const skyMaterial = new THREE.MeshBasicMaterial({ color: skyColor, side: THREE.BackSide });
    const skyGeo = new THREE.SphereGeometry(500, 32, 32);
    const sky = new THREE.Mesh(skyGeo, skyMaterial);
    scene.add(sky);

    // Road (Repeat Texture)
    const roadTexture = new THREE.TextureLoader().load('https://threejsfundamentals.org/threejs/resources/images/checker.png');
    roadTexture.wrapS = roadTexture.wrapT = THREE.RepeatWrapping;
    roadTexture.repeat.set(10, 200);
    const roadMaterial = new THREE.MeshStandardMaterial({ map: roadTexture });
    const road = new THREE.Mesh(new THREE.PlaneGeometry(10, 2000), roadMaterial);
    road.rotation.x = -Math.PI / 2;
    scene.add(road);

    // Car Model (Simple)
    const car = new THREE.Mesh(
      new THREE.BoxGeometry(1, 0.5, 2),
      new THREE.MeshStandardMaterial({ color: 0xff0000 })
    );
    car.position.y = 0.25;
    scene.add(car);

    // Lighting
    const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
    scene.add(ambientLight);
    const dirLight = new THREE.DirectionalLight(0xffffff, 0.5);
    dirLight.position.set(5, 10, 7.5);
    scene.add(dirLight);

    // Trees (for side scenery)
    const treeGeometry = new THREE.CylinderGeometry(0, 0.2, 1, 4);
    const treeMaterial = new THREE.MeshStandardMaterial({ color: 0x228B22 });
    for (let i = -50; i < 1000; i += 20) {
      const leftTree = new THREE.Mesh(treeGeometry, treeMaterial);
      leftTree.position.set(-5, 0.5, -i);
      scene.add(leftTree);

      const rightTree = leftTree.clone();
      rightTree.position.x = 5;
      scene.add(rightTree);
    }

    // Controls
    let speed = 0;
    const brakeBtn = document.getElementById('brake');
    const accelBtn = document.getElementById('accelerate');

    brakeBtn.addEventListener('touchstart', () => speed = Math.max(speed - 0.02, 0));
    accelBtn.addEventListener('touchstart', () => speed = Math.min(speed + 0.02, 0.2));

    window.addEventListener('deviceorientation', (event) => {
      const tilt = event.gamma / 30; // left/right
      car.position.x = THREE.MathUtils.clamp(tilt * 5, -4, 4);
    });

    // Animate
    function animate() {
      requestAnimationFrame(animate);

      road.position.z += speed * 10;
      road.position.z %= 100;

      camera.position.z = car.position.z + 10;
      camera.lookAt(car.position);

      renderer.render(scene, camera);
    }
    animate();

    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth/window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>
